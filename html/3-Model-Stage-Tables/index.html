
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Get up to the Stage &#8212; Analytic Engineering &amp; dbt: 0-100</title>
    
  <link rel="stylesheet" href="../_static/css/index.d431a4ee1c1efae0e38bdfebc22debff.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.bfb7730f9caf2ec0b46a44615585038c.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.30270b6e4c972e43c488.js">

    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script type="text/javascript" src="../_static/togglebutton.js"></script>
    <script type="text/javascript" src="../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript">var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script type="text/javascript" src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" type="text/javascript" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script type="text/javascript">
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" type="text/javascript" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="1. What are the Facts?" href="../4-Model-Mart-Tables/index.html" />
    <link rel="prev" title="3. Development in BASE" href="../2-III-Materialization-Development/index.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Analytic Engineering & dbt: 0-100</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Analytic Engineering &amp; dbt: 0-100
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../0-Installation/index.html">
   1. Installation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Creating a Project
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../1-Create-A-Project/index.html">
   1. Creating a Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Base/Raw Extraction
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../2-I-Source-Config/index.html">
   1. Source Configuration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2-II-Instantiate-Base-Tables/index.html">
   2. Instantiate your Base Tables!
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2-III-Materialization-Development/index.html">
   3. Development in BASE
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Staging Transformations
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Get up to the Stage
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Mart Reporting
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4-Model-Mart-Tables/index.html">
   1. What are the Facts?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-Model-Mart-Tables/index.html#dimension-and-fact-tables">
   2. Dimension and Fact Tables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-Model-Mart-Tables/index.html#embedding-business-logic">
   3. Embedding Business Logic
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Documentation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../5-Documentation/index.html">
   1. Documention
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Additional Content
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../6-Advanced-Tests/index.html">
   1. Testing, Testing…
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../7-Advanced-Templates/index.html">
   2. Templating &amp; Macros
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Next Steps
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Thank-You/index.html">
   1. Next Steps!
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/3-Model-Stage-Tables/index.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/CloudChaoszero/dbtOfCourse"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/CloudChaoszero/dbtOfCourse/issues/new?title=Issue%20on%20page%20%2F3-Model-Stage-Tables/index.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="get-up-to-the-stage">
<h1>Get up to the Stage<a class="headerlink" href="#get-up-to-the-stage" title="Permalink to this headline">¶</a></h1>
<p>Great, now we’ve done some data cleaning and related items in the BASE layer. Now, let’s distance ourselves from the essential (Analytics) Data Engineering implementations and proceed on to some more interesting items– in the Staging layer!</p>
<p>You can find the video summary for <a class="reference external" href="https://www.youtube.com/watch?v=hRCR4ahO1H0&amp;list=PL83V3nc76mDrEfz1rRZ3L2fDYXDGm8yLk&amp;index=9&amp;t=0s">this here.</a></p>
<p>The following are some of the things to consider in this implementation:</p>
<ul class="simple">
<li><p>Column renaming</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Required</span></code>, if not implemented in BASE layer</p></li>
</ul>
</li>
<li><p>JOIN data, if foreign keys exist</p></li>
<li><p>Filtering</p></li>
<li><p>Custom fields</p>
<ul>
<li><p>E.g. transforming an existing column</p></li>
</ul>
</li>
</ul>
<p>For example, the following attempts to JOIN other tables through foreign keys in preparation for our data warehouse.</p>
<blockquote>
<div><p>This can be done in the mart layer as well, but I like to do this here</p>
</div></blockquote>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>-- Create the stg_customer_income_band table with a CONCATentation, transformation.
WITH source AS (
    SELECT * FROM  {{ ref(&#39;snowflake_demo_income_band&#39;) }}
),

final AS (

    SELECT
        ib_income_band_sk AS income_band_sk,
        ib_lower_bound || &#39;-&#39; || ib_upper_bound AS income_band_bound
    FROM source
)

SELECT * FROM final
</pre></div>
</div>
<p>The following is an example of creating a STG layer views for our Customer Catalog Sales:</p>
<p><img alt="" src="https://media.giphy.com/media/LMM2nHKOS720Ev3PnX/giphy.gif" /></p>
<p>I created all the staging models through this command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dbt run --model stage.*
</pre></div>
</div>
<blockquote>
<div><p>You can find other related <a class="reference external" href="https://docs.getdbt.com/reference/node-selection/syntax#examples">dbt run commands here</a>.</p>
</div></blockquote>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dbtcourse"
        },
        kernelOptions: {
            kernelName: "dbtcourse",
            path: "./3-Model-Stage-Tables"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dbtcourse'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../2-III-Materialization-Development/index.html" title="previous page">3. Development in BASE</a>
    <a class='right-next' id="next-link" href="../4-Model-Mart-Tables/index.html" title="next page">1. What are the Facts?</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Raul Maldonado<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.30270b6e4c972e43c488.js"></script>


    
  </body>
</html>